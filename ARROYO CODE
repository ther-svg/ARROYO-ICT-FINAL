import pandas as pd
import numpy as np
import seaborn as sns
import matplotlib.pyplot as plt
from scipy import stats
import statsmodels.api as sm
import statsmodels.formula.api as smf


file_path = 'deither-excel.xlsx'
df = pd.read_excel(file_path)

print("Initial Data Preview:")
print(df.head())

print("\nMissing Values Count:")
print(df.isnull().sum())

df_clean = df.dropna()

print(f"\nCleaned dataset has {df_clean.shape[0]} rows and {df_clean.shape[1]} columns.")
assert df_clean.shape[0] >= 100, "Dataset does not meet minimum size requirement."


col1 = df_clean['Column1']
col2 = df_clean['Column2']

print("\nNumPy Operations:")
print("Mean of Column1:", np.mean(col1))
print("Std Dev of Column2:", np.std(col2))
print("Max of Column1:", np.max(col1))
print("Min of Column2:", np.min(col2))
print("Correlation (np.corrcoef):", np.corrcoef(col1, col2))


print("\nSciPy Pearson Correlation:")
corr, p_value = stats.pearsonr(col1, col2)
print(f"Correlation = {corr:.4f}, P-value = {p_value:.4f}")


print("\nStatsmodels Linear Regression:")
model = smf.ols('Column2 ~ Column1', data=df_clean).fit()
print(model.summary())


plt.figure(figsize=(8, 5))
sns.histplot(col1, kde=True, bins=30)
plt.title('Histogram of Column1')
plt.xlabel('Column1')
plt.ylabel('Frequency')
plt.show()


plt.figure(figsize=(8, 5))
sns.boxplot(x=col2)
plt.title('Boxplot of Column2')
plt.show()

plt.figure(figsize=(8, 6))
sns.regplot(x=col1, y=col2, data=df_clean, line_kws={"color": "red"})
plt.title('Correlation Plot with Regression Line')
plt.xlabel('Column1')
plt.ylabel('Column2')
plt.show()
